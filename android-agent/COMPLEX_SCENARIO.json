{
  "id": "complex-ad-parsing-scenario",
  "name": "Комплексный сценарий: Парсинг рекламных баннеров с уникализацией",
  "description": "1) Уникализация устройства (прокси, гео, таймзона, язык) → 2) Поиск в Google → 3) Переход на сайт → 4) 5-6 переходов внутри сайта с сбором addurl с баннеров → 5) Повторение с новой уникализацией",
  "version": "1.0",
  "type": "parsing",
  "browser": "chrome",
  "proxy": "auto",
  "timeout": 600000,
  "retries": 2,
  "requires_root": true,
  "config": {
    "wait_for_ads": true,
    "scroll_before_extract": true,
    "take_screenshots": true,
    "human_like": true,
    "random_delays": true,
    "min_delay": 3000,
    "max_delay": 8000
  },
  "variables": {
    "search_query": "site:pickuplineinsider.com",
    "max_internal_pages": "6",
    "max_iterations": "3"
  },
  "steps": [
    {
      "id": "step_0",
      "type": "wait",
      "duration": 3000,
      "random_offset": 2000,
      "description": "Начальная задержка (имитация загрузки приложения)"
    },
    {
      "id": "step_1",
      "type": "navigate",
      "url": "https://www.pickuplineinsider.com/",
      "wait_for_load": true,
      "timeout": 30000,
      "description": "Прямой переход на сайт pickuplineinsider.com"
    },
    {
      "id": "step_2",
      "type": "wait",
      "duration": 6000,
      "random_offset": 3000,
      "description": "Ожидание полной загрузки сайта (имитация чтения)"
    },
    {
      "id": "step_11",
      "type": "scroll",
      "direction": "down",
      "pixels": 300,
      "smooth": true,
      "description": "Медленная прокрутка для загрузки баннеров"
    },
    {
      "id": "step_11b",
      "type": "wait",
      "duration": 2500,
      "random_offset": 1500,
      "description": "Пауза после прокрутки (имитация чтения)"
    },
    {
      "id": "step_11c",
      "type": "scroll",
      "direction": "down",
      "pixels": 300,
      "smooth": true,
      "description": "Продолжение прокрутки"
    },
    {
      "id": "step_12",
      "type": "wait",
      "duration": 4000,
      "random_offset": 2000,
      "description": "Ожидание загрузки рекламы"
    },
    {
      "id": "step_13",
      "type": "extract",
      "selector": "iframe[src]",
      "attribute": "src",
      "save_as": "ad_links",
      "multiple": true,
      "append": false,
      "description": "Извлечение ВСЕХ iframe (реклама загружается через iframe)"
    },
    {
      "id": "step_13b",
      "type": "extract",
      "selector": "a[href*='adurl']:not([href*='pickuplineinsider.com'])",
      "attribute": "href",
      "save_as": "ad_links",
      "multiple": true,
      "append": true,
      "extract_adurl": true,
      "description": "Извлечение ссылок с параметром adurl (только извлечение, без клика)"
    },
    {
      "id": "step_15",
      "type": "loop",
      "max_iterations": 6,
      "description": "Цикл переходов по внутренним страницам сайта",
      "steps": [
        {
          "id": "loop_step_1",
          "type": "wait",
          "duration": 3000,
          "random_offset": 2000,
          "description": "Пауза перед действием (имитация чтения)"
        },
        {
          "id": "loop_step_2",
          "type": "scroll",
          "direction": "down",
          "pixels": 250,
          "smooth": true,
          "description": "Медленная прокрутка страницы"
        },
        {
          "id": "loop_step_2b",
          "type": "wait",
          "duration": 2000,
          "random_offset": 1000,
          "description": "Пауза после прокрутки"
        },
        {
          "id": "loop_step_2c",
          "type": "scroll",
          "direction": "down",
          "pixels": 250,
          "smooth": true,
          "description": "Продолжение прокрутки"
        },
        {
          "id": "loop_step_3",
          "type": "wait",
          "duration": 3000,
          "random_offset": 1500,
          "description": "Ожидание после прокрутки (имитация чтения контента)"
        },
        {
          "id": "loop_step_4",
          "type": "extract",
          "selector": "iframe[src]",
          "attribute": "src",
          "save_as": "ad_links",
          "multiple": true,
          "append": true,
          "description": "Сбор ВСЕХ iframe (реклама)"
        },
        {
          "id": "loop_step_4b",
          "type": "extract",
          "selector": "a[href*='adurl']:not([href*='pickuplineinsider.com'])",
          "attribute": "href",
          "save_as": "ad_links",
          "multiple": true,
          "append": true,
          "extract_adurl": true,
          "description": "Сбор ссылок с adurl (только извлечение, без клика)"
        },
        {
          "id": "loop_step_5",
          "type": "wait",
          "duration": 2000,
          "random_offset": 1000,
          "description": "Пауза перед кликом"
        },
        {
          "id": "loop_step_6",
          "type": "click",
          "selector": "a[href*='pickuplineinsider.com']:not([href*='#']):not([href*='javascript']):not([href*='mailto']):not([href*='tel']):not([href*='googleads']):not([href*='doubleclick']):not([href*='googlesyndication']):not([href*='adurl']):not([href*='pagead'])",
          "optional": false,
          "timeout": 8000,
          "description": "Клик по внутренней ссылке сайта (исключая рекламные ссылки)"
        },
        {
          "id": "loop_step_7",
          "type": "wait",
          "duration": 5000,
          "random_offset": 3000,
          "description": "Ожидание загрузки новой страницы (имитация чтения)"
        },
        {
          "id": "loop_step_8",
          "type": "scroll",
          "direction": "down",
          "pixels": 300,
          "smooth": true,
          "description": "Прокрутка новой страницы"
        },
        {
          "id": "loop_step_8b",
          "type": "wait",
          "duration": 2000,
          "random_offset": 1000,
          "description": "Пауза после прокрутки"
        },
        {
          "id": "loop_step_9",
          "type": "wait",
          "duration": 4000,
          "random_offset": 2000,
          "description": "Ожидание загрузки баннеров на новой странице"
        }
      ]
    },
    {
      "id": "step_16",
      "type": "wait",
      "duration": 3000,
      "random_offset": 2000,
      "description": "Финальная пауза"
    },
    {
      "id": "step_17",
      "type": "screenshot",
      "full_page": false,
      "description": "Финальный скриншот"
    }
  ],
  "post_process": {
    "extract_adurl": true,
    "deduplicate_domains": true,
    "save_to_backend": true,
    "export_format": "json"
  },
  "output": {
    "format": "json",
    "include_screenshots": true,
    "include_metadata": true
  }
}

